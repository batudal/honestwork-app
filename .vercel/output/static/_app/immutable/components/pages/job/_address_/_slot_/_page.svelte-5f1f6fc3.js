import{S as me,i as _e,s as be,k as n,a as y,x as ne,q as J,a7 as ge,l as c,h as r,c as j,m as i,y as ce,r as S,n as h,p as L,I as e,b as W,z as ie,J as pe,u as ye,f as de,t as ue,A as he,K as je,M as fe,a2 as $e,C as Ee}from"../../../../../chunks/paths-5beb49a4.js";import{J as we}from"../../../../../chunks/JobPage-748d152a.js";import{t as se,g as Ie,u as ke}from"../../../../../chunks/Network-167d2a19.js";import"../../../../../chunks/State-2b27296f.js";import{T as Pe}from"../../../../../chunks/Tiptap-de3b0f69.js";import{p as ve}from"../../../../../chunks/Parser-b5911fd6.js";import{C as Ae}from"../../../../../chunks/Validation-36c7cf0a.js";function Ce(d){let f,_,v,w,a,p,A,I,N,u,s,o,l,O,b,z,K,T,B,k,P,F,q,G,Q,$,R,U,x,X,C,E,M,Y,ae;return p=new we({props:{job:d[0].job,show_tags:!0}}),E=new Pe({props:{editable:!0}}),E.$on("content",d[3]),{c(){f=n("meta"),_=y(),v=n("div"),w=y(),a=n("main"),ne(p.$$.fragment),A=y(),I=n("div"),N=y(),u=n("div"),s=n("div"),o=n("div"),l=n("p"),O=J("cover letter "),b=n("span"),z=J("(optional"),K=y(),T=n("div"),B=y(),k=n("p"),P=n("span"),F=J(" "),q=J(d[1]),G=J("/1000)"),Q=y(),$=n("p"),R=J("apply"),U=y(),x=n("div"),X=y(),C=n("div"),ne(E.$$.fragment),this.h()},l(t){const m=ge("svelte-5ug5y9",document.head);f=c(m,"META",{name:!0,content:!0}),m.forEach(r),_=j(t),v=c(t,"DIV",{style:!0}),i(v).forEach(r),w=j(t),a=c(t,"MAIN",{class:!0});var g=i(a);ce(p.$$.fragment,g),A=j(g),I=c(g,"DIV",{style:!0}),i(I).forEach(r),N=j(g),u=c(g,"DIV",{class:!0});var D=i(u);s=c(D,"DIV",{class:!0});var H=i(s);o=c(H,"DIV",{class:!0});var V=i(o);l=c(V,"P",{});var Z=i(l);O=S(Z,"cover letter "),b=c(Z,"SPAN",{class:!0});var re=i(b);z=S(re,"(optional"),re.forEach(r),Z.forEach(r),K=j(V),T=c(V,"DIV",{style:!0}),i(T).forEach(r),B=j(V),k=c(V,"P",{class:!0});var ee=i(k);P=c(ee,"SPAN",{class:!0});var te=i(P);F=S(te," "),q=S(te,d[1]),te.forEach(r),G=S(ee,"/1000)"),ee.forEach(r),V.forEach(r),Q=j(H),$=c(H,"P",{class:!0});var oe=i($);R=S(oe,"apply"),oe.forEach(r),H.forEach(r),U=j(D),x=c(D,"DIV",{style:!0}),i(x).forEach(r),X=j(D),C=c(D,"DIV",{class:!0});var le=i(C);ce(E.$$.fragment,le),le.forEach(r),D.forEach(r),g.forEach(r),this.h()},h(){document.title="HW | Job Listing",h(f,"name","description"),h(f,"content","HonestWork Job Page"),L(v,"height","16px"),L(I,"width","12px"),h(b,"class","light-60"),L(T,"height","8px"),h(P,"class","yellow"),h(k,"class","light-60"),h(o,"class","left svelte-kj7vw"),h($,"class","yellow link"),h(s,"class","cover-head svelte-kj7vw"),L(x,"height","8px"),h(C,"class","description svelte-kj7vw"),h(u,"class","cover-letter svelte-kj7vw"),h(a,"class","svelte-kj7vw")},m(t,m){e(document.head,f),W(t,_,m),W(t,v,m),W(t,w,m),W(t,a,m),ie(p,a,null),e(a,A),e(a,I),e(a,N),e(a,u),e(u,s),e(s,o),e(o,l),e(l,O),e(l,b),e(b,z),e(o,K),e(o,T),e(o,B),e(o,k),e(k,P),e(P,F),e(P,q),e(k,G),e(s,Q),e(s,$),e($,R),e(u,U),e(u,x),e(u,X),e(u,C),ie(E,C,null),M=!0,Y||(ae=[pe($,"click",d[2]),pe($,"keydown",d[4])],Y=!0)},p(t,[m]){const g={};m&1&&(g.job=t[0].job),p.$set(g),(!M||m&2)&&ye(q,t[1])},i(t){M||(de(p.$$.fragment,t),de(E.$$.fragment,t),M=!0)},o(t){ue(p.$$.fragment,t),ue(E.$$.fragment,t),M=!1},d(t){r(f),t&&r(_),t&&r(v),t&&r(w),t&&r(a),he(p),he(E),Y=!1,je(ae)}}}function De(d,f,_){let v,w;fe(d,Ie,s=>_(6,v=s)),fe(d,ke,s=>_(7,w=s));let{data:a}=f,p,A=0;const I=async()=>{const s={user_address:v,job_id:`job:${a.job.user_address}:${a.job.slot}`,cover_letter:ve(p)};let o=Ae.safeParse(s);if(!o.success){for(let l=0;l<o.error.errors.length;l++)se.push(`<p class="light-60"><span style='color:var(--color-error)'>${o.error.errors[l].path}: </span>${o.error.errors[l].message}</p>`);return}if(w)try{const l=`${Ee}/api/job_apply/${a.job.user_address}/${a.job.slot}`,b=await(await fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_address:v,job_id:`job:${a.job.user_address}:${a.job.slot}`,cover_letter:p})})).json();b=="success"?se.push(`<p class="light-60"><span style='color:var(--color-success)'>success: </span>Application received.</p>`):se.push(`<p class="light-60"><span style='color:var(--color-error)'>error: </span>${b}</p>`)}catch(l){console.log(l)}},N=s=>{p=JSON.stringify(s.detail.content),_(1,A=ve(p).length)};function u(s){$e.call(this,d,s)}return d.$$set=s=>{"data"in s&&_(0,a=s.data)},[a,A,I,N,u]}class Oe extends me{constructor(f){super(),_e(this,f,De,Ce,be,{data:0})}}export{Oe as default};
